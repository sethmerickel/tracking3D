"""
EARTH OCCLUSION FEATURE - Implementation Notes
===============================================

The simulation now includes Earth occlusion detection. When enabled, satellites cannot
detect the missile if Earth blocks the line-of-sight vector.

Mathematical Model
------------------

To determine if Earth occludes the LOS:

1. Compute the line-of-sight vector: los_vec = r_missile - r_satellite

2. Find the closest point on the LOS line to Earth's center:
   - Project Earth center onto LOS line using dot product
   - Parameter t = (r_earth_center · los_unit) / ||los_vec||
   - Closest point = r_satellite + t * los_vec

3. Calculate minimum distance from Earth center to LOS line:
   - dist_to_los = ||closest_point||

4. Check occlusion:
   - If dist_to_los < R_earth + margin → LOS is occluded
   - If missile_distance < R_earth → missile is below surface (invalid)

This geometric test is efficient (O(1) per measurement) and physically accurate.

Usage
-----

In main.py, call:
    measurements_dfs, truth_df = simulate_measurements(
        satellites, missile, time_array_s,
        measurement_noise_std=0.001,
        include_occlusion=True  # Enable occlusion checking
    )

When enabled, satellites will skip measurements when Earth blocks their view,
creating realistic measurement gaps during orbital passes.

Performance Impact
------------------

- Minimal: Only adds a dot product and distance calculation per measurement
- Occlusion checking scales linearly with number of satellites
- No change to tracking algorithm, only measurement generation
"""
